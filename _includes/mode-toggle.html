<!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      this.setDark();  // Start the application in dark mode
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    flipMode() {
      if (this.isDarkMode) {
        this.setLight();
      } else {
        this.setDark();
      }
      this.notify();
    }

    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.mode === ModeToggle.DARK_MODE ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE
      }, '*');
    }
  }

  const modeToggle = new ModeToggle();
</script>